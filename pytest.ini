[pytest]
# ── Dossier des tests ─────────────────────────────────────────────────────────
testpaths = tests

# ── Découverte ────────────────────────────────────────────────────────────────
python_files   = test_*.py
python_classes = Test*
python_functions = test_*

# ── Options par défaut ────────────────────────────────────────────────────────
addopts =
    -v
    --tb=short
    --strict-markers
    --color=yes
    -p no:warnings

# ── Marqueurs personnalisés ───────────────────────────────────────────────────
markers =
    unit:        Tests unitaires (rapides, sans I/O externe)
    integration: Tests d'intégration (DB, Redis, HTTP)
    slow:        Tests lents (> 2 secondes)
    plugin:      Tests liés aux plugins
    auth:        Tests d'authentification
    admin:       Tests des routes admin
    skip_ci:     Tests à ignorer en CI

# ── Timeout global (évite les tests qui bloquent) ────────────────────────────
timeout = 30

# ── Couverture de code ────────────────────────────────────────────────────────
# Lancer avec : pytest --cov=xcore --cov=extensions --cov-report=term-missing
